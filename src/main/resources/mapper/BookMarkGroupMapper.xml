<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.api.server.dao.BookMarkGroupMapper">
	
	<resultMap id="bookMarkGroupResponse" type="com.api.server.model.bookmarkgroup.BookMarkGroupResponse" autoMapping="true"/>
	
	<select id="selectBookMarkGroups" resultMap="bookMarkGroupResponse">
 		SELECT * FROM BOOK_MARK_GROUP 
 		WHERE 1=1
 		<if test='userId != null'>
 		 AND USER_ID = #{userId} 
 		</if>
 		ORDER BY REG_DT DESC
	</select>
	
	
	<update id="updateBookMarkGroup">
 		UPDATE BOOK_MARK_GROUP SET
 		  TITLE = #{title}
 		 ,MOD_DT = NOW()
 		 ,MOD_ID = #{userId}
 		WHERE ID IN
 		<foreach collection="id" item="item" open="(" close=")" separator=",">
			#{item}
        </foreach>
 		<if test='userId != null'>
 		 AND USER_ID = #{userId} 
 		</if>
	</update>
	
	
	<insert id="createBookMarkGroup">
 		INSERT INTO BOOK_MARK_GROUP (
 			 ID
 			,USER_ID
 			,TITLE
 			,REG_DT
 			,REG_ID
 			,MOD_DT
 			,MOD_ID
 		) VALUES (
 			 #{id}
 			,#{userId}
 			,#{title}
 			,NOW()
 			,#{userId}
 			,NOW()
 			,#{userId}
 		)
	</insert>
	
	
	<delete id="deleteBookMarkGroup">
 		DELETE FROM BOOK_MARK_GROUP
 		WHERE USER_ID = #{userId}
 		AND ID IN
 		<foreach collection="id" item="item" open="(" close=")" separator=",">
			#{item}
        </foreach>
	</delete>
	
	
	<delete id="deleteBookMarkGroups">
 		DELETE FROM BOOK_MARK_GROUP
	</delete>
	
	
	<select id="checkBookMarkGroupByName" resultType="int">
 		SELECT 
 			COUNT(*) 
 		FROM BOOK_MARK_GROUP
 		WHERE TITLE = #{title}
	</select>
</mapper>